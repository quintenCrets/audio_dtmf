<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1709px" preserveAspectRatio="none" style="width:1459px;height:1709px;" version="1.1" viewBox="0 0 1459 1709" width="1459px" zoomAndPan="magnify"><defs><filter height="300%" id="fl7f3hnubz1k4" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="193" x="639" y="16.708">Detailed System Flow</text><!--MD5=[f7a7ee0c51b4e04c55c1f405505b5a33]
cluster Main Loop--><polygon fill="#FFFFFF" filter="url(#fl7f3hnubz1k4)" points="22,44.9531,108,44.9531,115,67.25,406,67.25,406,565.9531,22,565.9531,22,44.9531" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22" x2="115" y1="67.25" y2="67.25"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="26" y="59.9482">Main Loop</text><!--MD5=[8803432a49d341f64d8a09fc556abae7]
cluster Timer Interrupt Service Routine (Timer_ISR)--><polygon fill="#FFFFFF" filter="url(#fl7f3hnubz1k4)" points="438,375.4531,786,375.4531,793,397.75,858,397.75,858,1338.9531,438,1338.9531,438,375.4531" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="438" x2="793" y1="397.75" y2="397.75"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="342" x="442" y="390.4482">Timer Interrupt Service Routine (Timer_ISR)</text><!--MD5=[3d50f7ef3d7f195080ca323a1ea597dc]
cluster Process Audio Data Function (process_audio_data)--><polygon fill="#FFFFFF" filter="url(#fl7f3hnubz1k4)" points="890,44.9531,1295,44.9531,1302,67.25,1437,67.25,1437,1697.9531,890,1697.9531,890,44.9531" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="890" x2="1302" y1="67.25" y2="67.25"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="399" x="894" y="59.9482">Process Audio Data Function (process_audio_data)</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="213.2344" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="237" x="38.5" y="336.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="38.5" x2="275.5" y1="526.2188" y2="526.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="115" y="354.9482">Initialization:</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="123" x="95.5" y="371.2451">- Initialize Platform</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="96" x="109" y="387.542">- Configure IIC</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="146" x="84" y="403.8389">- Configure Audio PLL</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="158" x="78" y="420.1357">- Configure Audio Jacks</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="145" x="84.5" y="436.4326">- Print Initial Message</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="155" x="79.5" y="452.7295">- Initialize FFT Instance</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="139" x="87.5" y="469.0264">- Initialize SCU Timer</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="156" x="79" y="485.3232">- Setup Timer Interrupt</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="208" x="53" y="501.6201">- Configure Timer for Sampling</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="115" y="517.917">- Start Timer</text><text fill="#000000" font-family="monospace" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="217" x="43.5" y="542.3574">+ Audio State = STATE_BUFFERING</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="52.5938" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="200" x="38" y="206.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="38" x2="238" y1="249.5469" y2="249.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="166" x="55" y="224.9482">Continuous Processing:</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="180" x="48" y="241.2451">- Calls Process Audio Data</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="137" x="42.5" y="79.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="42.5" x2="179.5" y1="106.25" y2="106.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="117" x="52.5" y="97.9482">Cleanup Platform</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="223" x="508.5" y="1264.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="508.5" x2="731.5" y1="1291.25" y2="1291.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="203" x="518.5" y="1282.9482">Check Audio State (Buffering)</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="238" x="541" y="1137.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="541" x2="779" y1="1164.25" y2="1164.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="218" x="551" y="1155.9482">Read Audio Input (Left Channel)</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="216" x="546" y="1026.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="546" x2="762" y1="1053.25" y2="1053.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="196" x="556" y="1044.9482">Store Sample in Audio Buffer</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="186" x="538" y="899.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="538" x2="724" y1="926.25" y2="926.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="166" x="548" y="917.9482">Increment Sample Index</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="147" x="543.5" y="772.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="543.5" x2="690.5" y1="799.25" y2="799.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="127" x="553.5" y="790.9482">Check if Buffer Full</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="157" x="575.5" y="612.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="575.5" x2="732.5" y1="639.25" y2="639.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="137" x="585.5" y="630.9482">Reset Sample Index</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="225" x="541.5" y="418.4531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="541.5" x2="766.5" y1="444.75" y2="444.75"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="205" x="551.5" y="436.4482">Set Audio State to Processing</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="470" y="612.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="470" x2="540" y1="639.25" y2="639.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="480" y="630.9482">Exit ISR</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="238" x="924" y="1631.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="924" x2="1162" y1="1658.25" y2="1658.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="218" x="934" y="1649.9482">Check Audio State (Processing)</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="95" x="1014.5" y="1504.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1014.5" x2="1109.5" y1="1531.25" y2="1531.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="75" x="1024.5" y="1522.9482">Stop Timer</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="234" x="982" y="1393.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="982" x2="1216" y1="1420.25" y2="1420.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="214" x="992" y="1411.9482">Copy Audio Buffer (Processing)</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="228" x="996" y="1264.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="996" x2="1224" y1="1291.25" y2="1291.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="208" x="1006" y="1282.9482">Perform Real FFT (Processing)</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="251" x="987.5" y="1137.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="987.5" x2="1238.5" y1="1164.25" y2="1164.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="231" x="997.5" y="1155.9482">Calculate Magnitude (Processing)</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="292" x="977" y="1026.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="977" x2="1269" y1="1053.25" y2="1053.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="272" x="987" y="1044.9482">Detect DTMF Frequencies (Processing)</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="332" x="957" y="899.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="957" x2="1289" y1="926.25" y2="926.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="312" x="967" y="917.9482">Identify Low &amp; High Frequencies (Processing)</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="319" x="943.5" y="772.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="943.5" x2="1262.5" y1="799.25" y2="799.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="299" x="953.5" y="790.9482">Map Frequencies to Character (Processing)</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="160" x="1023" y="612.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1023" x2="1183" y1="639.25" y2="639.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="140" x="1033" y="630.9482">Print Detected Tone</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="1247" y="692.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1247" x2="1361" y1="719.25" y2="719.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="1257" y="710.9482">Print No Tone</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="301" x="952.5" y="418.4531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="952.5" x2="1253.5" y1="444.75" y2="444.75"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="281" x="962.5" y="436.4482">Set Audio State to Buffering (Processing)</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="186" x="976" y="208.4531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="976" x2="1162" y1="234.75" y2="234.75"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="166" x="986" y="226.4482">Start Timer (Processing)</text><rect fill="#FEFECE" filter="url(#fl7f3hnubz1k4)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="147" x="934.5" y="79.9531"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="934.5" x2="1081.5" y1="106.25" y2="106.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="127" x="944.5" y="97.9482">Exit Process Audio</text><!--MD5=[7ceebff33fac604e9b9c27e48f5b1001]
reverse link main_loop to initialization--><path d="M140.81,265.2131 C142.57,284.5031 144.96,310.6231 147.36,336.8731 " fill="none" id="main_loop&lt;-initialization" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="140.33,259.9531,137.1685,269.2808,140.7865,264.9322,145.1351,268.5503,140.33,259.9531" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[587843713505aebf125a42d8351a7493]
reverse link main_loop to main_loop--><path d="M243.2,222.2931 C260.83,223.8531 273,227.5731 273,233.4531 C273,239.8931 258.43,243.7331 238.09,244.9931 " fill="none" id="main_loop&lt;-main_loop" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="238.09,221.9131,246.7689,226.5689,243.0763,222.2835,247.3616,218.5909,238.09,221.9131" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="279" y="238.02">Loops continuously</text><!--MD5=[9ef253f3a07511f70f204205124ef205]
reverse link cleanup to main_loop--><path d="M117.22,135.0931 C121.84,156.7231 128.07,185.9431 132.51,206.7131 " fill="none" id="cleanup&lt;-main_loop" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="116.14,130.0431,114.1011,139.6786,117.1808,134.9336,121.9259,138.0133,116.14,130.0431" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="277" x="127" y="173.02">End of program (though it's an infinite loop)</text><!--MD5=[f5c399b2e759cd6fd07ae4e95ca24d57]
reverse link read_audio to check_buffering--><path d="M650.75,1192.8731 C643.75,1214.7231 634.27,1244.3731 627.69,1264.9231 " fill="none" id="read_audio&lt;-check_buffering" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="652.29,1188.0531,645.7285,1195.398,650.7604,1192.8134,653.345,1197.8453,652.29,1188.0531" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="643" y="1231.02">If STATE_BUFFERING</text><!--MD5=[07bef008769ea588413fffe92070370b]
reverse link exit_isr to check_buffering--><path d="M499.08,668.0431 C483.31,752.5031 446.56,1003.4031 524,1187.9531 C537.11,1219.1831 564.59,1246.4631 586.8,1264.7731 " fill="none" id="exit_isr&lt;-check_buffering" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="500.04,662.9631,494.4385,671.064,499.1117,667.8762,502.2994,672.5493,500.04,662.9631" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="481" y="993.02">Otherwise</text><!--MD5=[7b98df32e3fe3b6c4f4d4ac583e2b833]
reverse link store_sample to read_audio--><path d="M655.62,1082.3831 C656.58,1099.7531 657.77,1121.4731 658.67,1137.8331 " fill="none" id="store_sample&lt;-read_audio" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="655.33,1077.1431,651.8252,1086.3473,655.6018,1082.1357,659.8133,1085.9124,655.33,1077.1431" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[143a55a4a1c9616d5aafe1d7f3f02618]
reverse link inc_index to store_sample--><path d="M636.37,955.1431 C640.39,976.9731 645.81,1006.4531 649.58,1026.9231 " fill="none" id="inc_index&lt;-store_sample" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="635.43,950.0531,633.1437,959.6329,636.3445,954.9688,641.0087,958.1697,635.43,950.0531" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[b303f81afaae2aa1f3bddc02e5aabd58]
reverse link check_buffer_full to inc_index--><path d="M620.27,828.1431 C622.71,849.9731 626.02,879.4531 628.31,899.9231 " fill="none" id="check_buffer_full&lt;-inc_index" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="619.7,823.0531,616.7272,832.4426,620.2569,828.022,624.6775,831.5516,619.7,823.0531" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[e0229207d2d6cb018b1d8e1b22f839b0]
reverse link reset_index to check_buffer_full--><path d="M647.11,668.3531 C640.06,698.4931 629.21,744.7931 622.65,772.8431 " fill="none" id="reset_index&lt;-check_buffer_full" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="648.3,663.2931,642.345,671.1377,647.1548,668.1602,650.1323,672.97,648.3,663.2931" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="215" x="641" y="722.52">If sample_index &gt;= BUFFER_SIZE</text><!--MD5=[281d5f6051cfddb7b517d9a0231d2295]
reverse link set_processing to reset_index--><path d="M654,474.2531 C654,512.3531 654,577.5931 654,612.7731 " fill="none" id="set_processing&lt;-reset_index" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="654,468.8331,650,477.8331,654,473.8331,658,477.8331,654,468.8331" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[52e14c2cc6258ec1168c8fcec88e9952]
reverse link exit_isr to check_buffer_full--><path d="M516.02,667.9231 C525.12,689.7731 539.38,719.8131 557,742.9531 C565.24,753.7731 575.84,764.1431 585.85,772.8531 " fill="none" id="exit_isr&lt;-check_buffer_full" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="514.04,663.1231,513.7573,672.9679,515.9387,667.7486,521.1581,669.93,514.04,663.1231" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="558" y="722.52">Otherwise</text><!--MD5=[1aeb720eff53e1e1e46c40a285a17292]
reverse link stop_timer to check_processing_audio--><path d="M1057.56,1560.1431 C1054.24,1581.9731 1049.76,1611.4531 1046.65,1631.9231 " fill="none" id="stop_timer&lt;-check_processing_audio" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1058.34,1555.0531,1053.0234,1563.3437,1057.5829,1559.9955,1060.9312,1564.555,1058.34,1555.0531" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="1054" y="1598.02">If STATE_PROCESSING</text><!--MD5=[e428f318658983944fee3a0d5b2c16a4]
reverse link exit_process_audio to check_processing_audio--><path d="M967.98,133.3031 C939.77,156.1331 907,191.4731 907,232.4531 C907,232.4531 907,232.4531 907,718.9531 C907,867.2831 941,902.6231 941,1050.9531 C941,1050.9531 941,1050.9531 941,1530.9531 C941,1573.5231 976.96,1609.6131 1006.18,1631.9031 " fill="none" id="exit_process_audio&lt;-check_processing_audio" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="972.11,130.0231,962.5767,132.4964,968.1973,133.1361,967.5576,138.7567,972.11,130.0231" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="940" y="993.02">Otherwise</text><!--MD5=[738afa5ed5c09439cc0a14182fd22a64]
reverse link copy_processing_buffer to stop_timer--><path d="M1089.16,1448.9331 C1083.24,1466.3831 1075.79,1488.3331 1070.19,1504.8331 " fill="none" id="copy_processing_buffer&lt;-stop_timer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1090.79,1444.1431,1084.1034,1451.3743,1089.179,1448.8765,1091.6768,1453.952,1090.79,1444.1431" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[9349c974a95dc09fc80471fc13952f74]
reverse link rfft_processing to copy_processing_buffer--><path d="M1107.45,1320.3431 C1105.52,1342.6531 1102.9,1372.9631 1101.09,1393.8531 " fill="none" id="rfft_processing&lt;-copy_processing_buffer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1107.91,1315.1431,1103.1539,1323.7675,1107.4818,1320.1248,1111.1245,1324.4526,1107.91,1315.1431" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[db6a05910df48e105798ed3187d0b444]
reverse link magnitude_processing to rfft_processing--><path d="M1112.3,1193.1431 C1111.78,1214.9731 1111.07,1244.4531 1110.58,1264.9231 " fill="none" id="magnitude_processing&lt;-rfft_processing" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1112.42,1188.0531,1108.2154,1196.9594,1112.3057,1193.0518,1116.2133,1197.1422,1112.42,1188.0531" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[594334e1f71451828b34b7abe6b2f24e]
reverse link detect_freq_processing to magnitude_processing--><path d="M1120.3,1082.3831 C1118.71,1099.7531 1116.71,1121.4731 1115.21,1137.8331 " fill="none" id="detect_freq_processing&lt;-magnitude_processing" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1120.78,1077.1431,1115.9749,1085.7403,1120.3235,1082.1222,1123.9415,1086.4708,1120.78,1077.1431" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[5d34c0c445a7af6e436f32cc180854cd]
reverse link identify_processing to detect_freq_processing--><path d="M1123,955.1431 C1123,976.9731 1123,1006.4531 1123,1026.9231 " fill="none" id="identify_processing&lt;-detect_freq_processing" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1123,950.0531,1119,959.0531,1123,955.0531,1127,959.0531,1123,950.0531" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[789075aa74b81a3a0c47e49636e760ca]
reverse link map_char_processing to identify_processing--><path d="M1107.67,828.1431 C1111.16,849.9731 1115.88,879.4531 1119.16,899.9231 " fill="none" id="map_char_processing&lt;-identify_processing" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1106.86,823.0531,1104.3268,832.5706,1107.6472,827.9908,1112.227,831.3112,1106.86,823.0531" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="1115" y="866.02">Detected</text><!--MD5=[0d2379f0328c48d95bf9e14586789f78]
reverse link print_detected to map_char_processing--><path d="M1103,668.3531 C1103,698.4931 1103,744.7931 1103,772.8431 " fill="none" id="print_detected&lt;-map_char_processing" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1103,663.2931,1099,672.2931,1103,668.2931,1107,672.2931,1103,663.2931" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[268d633f664f88e743462a9bbff2cc7d]
reverse link set_buffering_processing to print_detected--><path d="M1103,474.2531 C1103,512.3531 1103,577.5931 1103,612.7731 " fill="none" id="set_buffering_processing&lt;-print_detected" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1103,468.8331,1099,477.8331,1103,473.8331,1107,477.8331,1103,468.8331" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[538ec9730d9dc5f0eb170f0bf8126120]
reverse link print_no_tone to identify_processing--><path d="M1303.07,748.5231 C1301.06,770.7731 1295.4,801.0631 1280,822.9531 C1255.67,857.5431 1215.34,883.1231 1181.66,899.8731 " fill="none" id="print_no_tone&lt;-identify_processing" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1303.49,743.3431,1298.7831,751.9944,1303.0901,748.3271,1306.7574,752.6342,1303.49,743.3431" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="1300" y="802.52">Not Detected</text><!--MD5=[a0e66854cb30be39f59456e6ab323d3b]
reverse link set_buffering_processing to print_no_tone--><path d="M1123.84,472.7031 C1163.47,526.4331 1249.06,642.4731 1286.2,692.8231 " fill="none" id="set_buffering_processing&lt;-print_no_tone" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1120.84,468.6331,1122.9795,478.2468,1123.8148,472.6519,1129.4096,473.4871,1120.84,468.6331" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[98d391359fab74e3a24eb06dc169277b]
reverse link start_timer_processing to set_buffering_processing--><path d="M1073.8,263.8431 C1080.57,305.2631 1092.79,380.0031 1099.06,418.3431 " fill="none" id="start_timer_processing&lt;-set_buffering_processing" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1072.97,258.7231,1070.4637,268.2477,1073.7711,263.6585,1078.3603,266.966,1072.97,258.7231" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[d3f405e104d85c71079f7c605e716d5d]
reverse link exit_process_audio to start_timer_processing--><path d="M1021.85,134.6631 C1032.59,156.9431 1047.31,187.4631 1057.43,208.4531 " fill="none" id="exit_process_audio&lt;-start_timer_processing" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1019.62,130.0431,1019.9166,139.8875,1021.7874,134.549,1027.1259,136.4197,1019.62,130.0431" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[a302d2fc74bf6ec3db956526e63e84a2]
link main_loop to Timer Interrupt Service Routine (Timer_ISR)--><path d="M238.23,251.8431 C293.98,266.1731 360.98,291.8031 406,336.9531 C414.7125,345.6931 421.5594,356.5206 426.9313,367.8789 C429.6172,373.558 431.9344,379.3699 433.9316,385.1198 C434.9303,387.9948 435.8489,390.8543 436.6937,393.674 C437.1161,395.0838 437.52,396.4837 437.9062,397.8707 " fill="none" id="main_loop-&gt;Timer Interrupt Service Routine (Timer_ISR)" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="437.9062,397.8707,439.3452,388.1275,436.5649,393.0539,431.6385,390.2736,437.9062,397.8707" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="364" y="303.02">Occurs at sampling rate</text><!--MD5=[fcbf6195dda14d686f29a416a0b8aa15]
@startuml FlowChart
allowmixing

title Detailed System Flow

package "Main Loop" {
  state "Initialization:\n- Initialize Platform\n- Configure IIC\n- Configure Audio PLL\n- Configure Audio Jacks\n- Print Initial Message\n- Initialize FFT Instance\n- Initialize SCU Timer\n- Setup Timer Interrupt\n- Configure Timer for Sampling\n- Start Timer" as initialization
  initialization : ""+ Audio State = STATE_BUFFERING""
  state "Continuous Processing:\n- Calls Process Audio Data" as main_loop
  state "Cleanup Platform" as cleanup

  main_loop <- - initialization 
  main_loop <- - main_loop : Loops continuously
  cleanup <- - main_loop : End of program (though it's an infinite loop)
}

package "Timer Interrupt Service Routine (Timer_ISR)" {
  state "Check Audio State (Buffering)" as check_buffering
  state "Read Audio Input (Left Channel)" as read_audio
  state "Store Sample in Audio Buffer" as store_sample
  state "Increment Sample Index" as inc_index
  state "Check if Buffer Full" as check_buffer_full
  state "Reset Sample Index" as reset_index
  state "Set Audio State to Processing" as set_processing
  state "Exit ISR" as exit_isr

  read_audio <- - check_buffering : If STATE_BUFFERING
  exit_isr <- - check_buffering : Otherwise
  store_sample <- - read_audio
  inc_index <- - store_sample
  check_buffer_full <- - inc_index 
  reset_index <- - check_buffer_full : If sample_index >= BUFFER_SIZE
  set_processing <- - reset_index
  exit_isr <- - check_buffer_full : Otherwise
}

package "Process Audio Data Function (process_audio_data)" {
  state "Check Audio State (Processing)" as check_processing_audio
  state "Stop Timer" as stop_timer
  state "Copy Audio Buffer (Processing)" as copy_processing_buffer
  state "Perform Real FFT (Processing)" as rfft_processing
  state "Calculate Magnitude (Processing)" as magnitude_processing
  state "Detect DTMF Frequencies (Processing)" as detect_freq_processing
  state "Identify Low & High Frequencies (Processing)" as identify_processing
  state "Map Frequencies to Character (Processing)" as map_char_processing
  state "Print Detected Tone" as print_detected
  state "Print No Tone" as print_no_tone
  state "Set Audio State to Buffering (Processing)" as set_buffering_processing
  state "Start Timer (Processing)" as start_timer_processing
  state "Exit Process Audio" as exit_process_audio

  stop_timer <- - check_processing_audio : If STATE_PROCESSING
  exit_process_audio <- - check_processing_audio : Otherwise
  copy_processing_buffer <- - stop_timer
  rfft_processing <- - copy_processing_buffer
  magnitude_processing <- - rfft_processing
  detect_freq_processing <- - magnitude_processing
  identify_processing <- - detect_freq_processing
  map_char_processing <- - identify_processing : Detected
  print_detected <- - map_char_processing
  set_buffering_processing <- - print_detected
  print_no_tone <- - identify_processing : Not Detected
  set_buffering_processing <- - print_no_tone
  start_timer_processing <- - set_buffering_processing
  exit_process_audio <- - start_timer_processing
}

main_loop -[dashed]-> "Timer Interrupt Service Routine (Timer_ISR)" : Occurs at sampling rate
@enduml

PlantUML version 1.2020.02(Sun Mar 01 11:22:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 21.0.6+7-Ubuntu-124.04.1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>